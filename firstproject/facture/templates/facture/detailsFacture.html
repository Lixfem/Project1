{% extends 'facture/base.html' %}

{% block title %}DÃ©tails de la facture #{{facture.numeroFacture}}{% endblock %}


{% block content %}
<div class="invoice-container">
    <!-- En-tÃªte de la facture -->
    <div class="invoice-header">
        <h1>Facture</h1>
        <div class="invoice-number">NÂ° {{facture.numeroFacture}}</div>
    </div>
    
    <div class="invoice-body">
        <!-- Informations client -->
        <div class="info-section">
            <h3>ğŸ“‹ Informations Client</h3>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Nom :</span>
                    <span class="info-value">{{client.clientFacture|default:"Non spÃ©cifiÃ©"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Email :</span>
                    <span class="info-value">{{client.emailClient|default:"Non spÃ©cifiÃ©"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">TÃ©lÃ©phone :</span>
                    <span class="info-value">{{client.telephoneClient|default:"Non spÃ©cifiÃ©"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Adresse :</span>
                    <span class="info-value">{{client.adresseClient|default:"Non spÃ©cifiÃ©e"}}</span>
                </div>
            </div>
        </div>
        
        <!-- Informations facture -->
        <div class="info-section">
            <h3>ğŸ“„ DÃ©tails de la Facture</h3>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Date de crÃ©ation :</span>
                    <span class="info-value">{{facture.dateCreationFacture|date:"d/m/Y Ã  H:i"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">DerniÃ¨re MAJ :</span>
                    <span class="info-value">{{facture.lastUpdateFacture|date:"d/m/Y Ã  H:i"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">CrÃ©Ã©e par :</span>
                    <span class="info-value">{{facture.factureSaveBy|default:"SystÃ¨me"}}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Statut :</span>
                    <span class="info-value">
                        {% if facture.statutFacture == 'PayÃ©e' or facture.statutFacture == 'PAID' %}
                            <span class="status-badge status-paid">{{facture.statutFacture}}</span>
                        {% elif facture.statutFacture == 'En attente' or facture.statutFacture == 'PENDING' %}
                            <span class="status-badge status-pending">{{facture.statutFacture}}</span>
                        {% else %}
                            <span class="status-badge status-overdue">{{facture.statutFacture}}</span>
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        
        <!-- Montant total -->
        <div class="info-section">
            <h3>ğŸ’° Montant</h3>
            <div class="total-amount">
                {{facture.totalFacture|floatformat:2}} Francs CFA
            </div>
        </div>
        
        <!-- Commentaires -->
        {% if facture.commentaireFacture %}
        <div class="info-section">
            <h3>ğŸ’­ Commentaire</h3>
            <div class="comment-section">
                {{facture.commentaireFacture|linebreaks}}
            </div>
        </div>
        {% endif %}
        
        <!-- Actions -->
        <div class="actions">
            <a href="{% url 'liste-facture' %}" class="btn btn-secondary">
                â† Retour Ã  la liste
            </a>
            
            {% if perms.facture.change_facture %}
            <a href="#" class="btn btn-primary">
                âœï¸ Modifier
            </a>
            {% endif %}
            
            <a href="#" class="btn btn-success" target="_blank">
                ğŸ–¨ï¸ Imprimer
            </a>
            
            {% if facture.statutFacture != 'PayÃ©e' %}
            <a href="#" class="btn btn-warning" 
               onclick="return confirm('Marquer cette facture comme payÃ©e ?')">
                âœ… Marquer payÃ©e
            </a>
            {% endif %}
            
            {% if perms.facture.delete_facture %}
            <a href="#" class="btn btn-danger" 
               onclick="return confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cette facture ?')"
               style="background: #dc3545;">
                ğŸ—‘ï¸ Supprimer
            </a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animation d'entrÃ©e
    const container = document.querySelector('.invoice-container');
    container.style.opacity = '0';
    container.style.transform = 'translateY(20px)';
    
    setTimeout(() => {
        container.style.transition = 'all 0.5s ease';
        container.style.opacity = '1';
        container.style.transform = 'translateY(0)';
    }, 100);
    
    // Effet hover sur les boutons
    const buttons = document.querySelectorAll('.btn');
    buttons.forEach(btn => {
        btn.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-2px)';
        });
        
        btn.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
});
</script>
{% endblock %}